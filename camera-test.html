<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Camera Test</title>

    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap-select/1.13.11/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap-notify/0.2.0/css/bootstrap-notify.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap-notify/0.2.0/css/styles/alert-bangtidy.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap-notify/0.2.0/css/styles/alert-blackgloss.min.css">
</head>

<body>
    <section id="container" class="container">
        <div class="controls">
            <fieldset class="input-group">
                <input type="file" accept="capture=camera">
                <button id="btnIdents">识别</button>
            </fieldset>
        </div>
        <div id="interactive" class="viewport"><br clear="all"></div>
    </section>

    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.staticfile.org/bootstrap-select/1.13.11/js/bootstrap-select.min.js"></script>
    <script src="https://cdn.staticfile.org/bootstrap-select/1.13.11/js/i18n/defaults-zh_CN.min.js"></script>
    <script src="https://cdn.staticfile.org/bootstrap-notify/0.2.0/js/bootstrap-notify.min.js"></script>
    <script src="https://cdn.staticfile.org/quagga/1.0.0-beta.2/quagga.min.js"></script>
    <script type="text/javascript">
 
        $(function() {var App = {
                init: function() {
                    App.attachListeners();
                },
                attachListeners: function() {
                    var self = this;
                    $("#btnIdents").on("click", function(e) {
                        var input = document.querySelector(".controls input[type=file]");
                        if (input.files && input.files.length) {
                            App.decode(URL.createObjectURL(input.files[0]));
                        }
                    });
                },
                decode: function(src) {
                    var self = this,
                        config = $.extend({}, self.state, {src: src});
                    Quagga.decodeSingle(config, function(result) {
                        //识别结果
                        if(result.codeResult){
                            console.log(result.codeResult.code);
                            alert("图片中的条形码为：" + result.codeResult.code);
                        }else{
                            alert("未识别到图片中的条形码！");
                        }
                    });
                },
                state: {
                    inputStream: {
                        size: 800,
                        singleChannel: false
                    },
                    locator: {
                        patchSize: "medium",
                        halfSample: true
                    },
                    decoder: {
                        readers: [{
                            format: "code_128_reader",
                            config: {}
                        }]
                    },
                    locate: true,
                    src: null
                }
            };
         
            App.init();
        });
        </script>
</body>

</html>